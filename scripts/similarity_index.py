import math
from pathlib import Path
from transformers import AutoTokenizer

model_name = "facebook/nllb-200-distilled-600M"
tokenizer = AutoTokenizer.from_pretrained(model_name)

def similarity_index (lang_code_list, tokenizer, filter_num):
    OUT_DIR = Path(f"./pmi_lang_pairs_data_{filter_num}filtered")
    OUT_DIR.mkdir(exist_ok=True)
    LANGS = lang_code_list
    k=0
    for lang_order_number in range(len(LANGS)):
        for lang_code2 in LANGS[(lang_order_number+1):]:
            lang_code1 = LANGS[lang_order_number]
            print(f"Calculations for {lang_code1} and {lang_code2} in progress")
            line_list1 = []
            line_list2 = []
            filename1 = f"/mnt/storage/sotnichenko/encoder-decoder-finetuning/europarlData/train.{lang_code1}"
            filename2 = f"/mnt/storage/sotnichenko/encoder-decoder-finetuning/europarlData/train.{lang_code2}"
            with open(filename1, "r") as f1:
                line_list1 = f1.readlines()
            with open(filename2, "r") as f2:
                line_list2 = f2.readlines()
            mutual_token_count = {}
            special_tokens = [
                0, 1, 2, 3, 5636, 248059, 256001, 256002, 256003, 256004, 256005, 2570, 256006, 256007, 256008, 256010, 256011, 256013, 256014, 256015, 256016, 256017, 256018, 256019, 256021, 256022, 256023, 256024, 256025, 256026, 256027, 256029, 256030, 256031, 256032, 256033, 256034, 256028, 256037, 256038, 256039, 256035, 256036, 256040, 256041, 256042, 45, 256043, 256044, 256045, 256046, 256047, 256048, 256049, 256050, 256051, 256052, 256053, 256054, 256055, 256056, 256057, 256058, 256059, 256060, 256061, 256062, 256063, 256064, 256065, 69, 256066, 256067, 256068, 256069, 256070, 256071, 256072, 256073, 2638, 256074, 256075, 81, 256076, 4179, 14419, 256077, 256078, 256079, 256080, 89, 256081, 256082, 256083, 256084, 256085, 15455, 13920, 256088, 256089, 256090, 256091, 256092, 256093, 256094, 104, 256096, 256097, 256098, 256099, 256100, 622, 256102, 256103, 256104, 256105, 256106, 256107, 256108, 256109, 256110, 256111, 256112, 256113, 256114, 256115, 256116, 256117, 256118, 256119, 256120, 256121, 256122, 256123, 256124, 256125, 256126, 12424, 256128, 256129, 256130, 256131, 256132, 256133, 256134, 256135, 256136, 146, 256138, 256139, 256140, 256141, 256142, 256143, 256144, 256145, 256146, 256147, 11933, 256149, 256150, 256151, 256152, 256153, 256154, 256155, 256156, 256157, 256158, 256159, 256160, 256161, 256162, 256163, 256164, 256165, 256166, 256167, 256168, 256169, 256170, 256171, 256172, 256173, 256174, 256175, 256176, 256177, 256178, 256179, 256180, 256181, 256182, 256183, 256184, 256185, 256186, 256187, 709, 256189, 256190, 256191, 256192, 256193, 256203, 256195, 256196, 256197, 256198, 256199, 256200, 256201, 256202, 9428, 83175, 238, 256086, 256188, 256087, 8969, 256194, 256095, 32556, 256101, 835, 1865, 1385, 256009, 256012, 10109, 18816, 385, 14229, 256020, 256127, 256148, 5582, 4589, 7662, 256137, 8693, 45, 69, 81, 89, 94, 104, 140, 146, 189, 192, 211, 214, 238, 284, 310, 315, 385, 436, 441, 460, 481, 539, 545, 617, 622, 666, 684, 700, 709, 757, 772, 799, 835, 855, 884, 1055, 1058, 1085, 1161, 1178, 1184, 1278, 1308, 1349, 1360, 1364, 1385, 1403, 1413, 1479, 1530, 1552, 1730, 1865, 1874, 1981, 1991, 2017, 2054, 2097, 2202, 2275, 2304, 2366, 2570, 2627, 2638, 2650, 2754, 2783, 2911, 2942, 2994, 3037, 3044, 3058, 3067, 3162, 3256, 3312, 3346, 3382, 3470, 3503, 3539, 3588, 3608, 3617, 3624, 3646, 3686, 3752, 3776, 3840, 3859, 3864, 3866, 3870, 3871, 3878, 3904, 3927, 3998, 4054, 4090, 4097, 4121, 4179, 4189, 4247, 4311, 4329, 4426, 4429, 4432, 4437, 4462, 4541, 4545, 4560, 4589, 4630, 4653, 4702, 4762, 4840, 4884, 4968, 5043, 5050, 5106, 5208, 5247, 5264, 5284, 5309, 5493, 5497, 5582, 5636, 5644, 5711, 5784, 5851, 5860, 5951, 6091, 6437, 6455, 6523, 6589, 6680, 6742, 6813, 6821, 6858, 6918, 6931, 6946, 7002, 7069, 7072, 7073, 7075, 7091, 7102, 7295, 7358, 7386, 7452, 7462, 7469, 7548, 7554, 7589, 7609, 7621, 7642, 7662, 7711, 7730, 7735, 7737, 7773, 7837, 7905, 7962, 8011, 8033, 8138, 8202, 8250, 8267, 8274, 8313, 8321, 8410, 8479, 8503, 8540, 8551, 8575, 8597, 8693, 8757, 8883, 8922, 8969, 8986, 9049, 9110, 9176, 9269, 9362, 9382, 9428, 9454, 9481, 9501, 9547, 9645, 9675, 9852, 9972, 9997, 10105, 10109, 10142, 10158, 10183, 10226, 10273, 10368, 10396, 10407, 10494, 10577, 10646, 10660, 10675, 10806, 10840, 11070, 11092, 11246, 11331, 11333, 11456, 11541, 11564, 11602, 11664, 11743, 11759, 11828, 11860, 11877, 11933, 12028, 12202, 12233, 12357, 12373, 12387, 12411, 12434, 12469, 12482, 12483, 12570, 12588, 12632, 12642, 12661, 12683, 12801, 12891, 12944, 13143, 13301, 13340, 13358, 13408, 13416, 13534, 13545, 13561, 13612, 13645, 13764, 13920, 14015, 14061, 14125, 14229, 14296, 14341, 14350, 14389, 14412, 14419, 14498, 14534, 14618, 14631, 14684, 14714, 14768, 14840, 14898, 14931, 14943, 15005, 15026, 15061, 15063, 15134, 15220, 15262, 15266, 15455, 15458, 15463, 15515, 15530, 15605, 15658, 15796, 15863, 15869, 15945, 16034, 16226, 16477, 16558, 16561, 16580, 16602, 16675, 16714, 16777, 16823, 16832, 16872, 16902, 16993, 17036, 17047, 17101, 17133, 17192, 17272, 17350, 17391, 17430, 17445, 17600, 17602, 17628, 17789, 17987, 18041, 18140, 18174, 18199, 18280, 18320, 18458, 18498, 18549, 18699, 18716, 18801, 18816, 18882, 18888, 18947, 18976, 19014, 19026, 19058, 19072, 19128, 19191, 19205, 19358, 19433, 19521, 19689, 20042, 20072, 20090, 20145, 20190, 20204, 20230, 20271, 20369, 20412, 20455, 20501, 20545, 20647, 20685, 20777, 20796, 20903, 21021, 21050, 21222, 21256, 21332, 21390, 21500, 21533, 21560, 21570, 21602, 21818, 21833, 21845, 21873, 21906, 21913, 21960, 21986, 22043, 22071, 22072, 22187, 22244, 22266, 22317, 22378, 22446, 22459, 22475, 22504, 22509, 22533, 22575, 22584, 22713, 22832, 22851, 23043, 23104, 23126, 23149, 23218, 23309, 23340, 23382, 23388, 23479, 23637, 23641, 23725, 23754, 23877, 23962, 24164, 24271, 24341, 24371, 24435, 24551, 24591, 24645, 24852, 24926, 24977, 25063, 25083, 25110, 25195, 25197, 25270, 25271, 25393, 25497, 25536, 25587, 25605, 25669, 25698, 25835, 26049, 26171, 26215, 26351, 26430, 26528, 26562, 26574, 26620, 26736, 26741, 26787, 26822, 26856, 26934, 27007, 27013, 27094, 27202, 27250, 27255, 27287, 27312, 27335, 27470, 27489, 27500, 27539, 27587, 27608, 27626, 27640, 27787, 27846, 27859, 27956, 27972, 27998, 28039, 28048, 28170, 28192, 28229, 28297, 28421, 28528, 28586, 28604, 28649, 28702, 28751, 28778, 28890, 28929, 28994, 29066, 29102, 29112, 29154, 29192, 29206, 29249, 29428, 29441, 29453, 29652, 29693, 29716, 29804, 29850, 29868, 29872, 29899, 29910, 29952, 30249, 30316, 30347, 30354, 30409, 30472, 30520, 30539, 30545, 30594, 30618, 30678, 30686, 30780, 30863, 30914, 30922, 30981, 30988, 31021, 31103, 31447, 31452, 31462, 31514, 31518, 31600, 31622, 31823, 31826, 31889, 31916, 32064, 32224, 32244, 32299, 32325, 32455, 32459, 32461, 32556, 32570, 32609, 32664, 32733, 32749, 32810, 32842, 32847, 32888, 33091, 33123, 33131, 33170, 33183, 33196, 33209, 33269, 33295, 33347, 33349, 33569, 33571, 33643, 33657, 33704, 33748, 33761, 33776, 33902, 33928, 33949, 33961, 34148, 34163, 34188, 34199, 34255, 34294, 34376, 34452, 34520, 34542, 34596, 34730, 34779, 34794, 35089, 35100, 35128, 35180, 35199, 35266, 35328, 35353, 35423, 35425, 35480, 35506, 35554, 35655, 35824, 35832, 35958, 35985, 36032, 36068, 36225, 36313, 36329, 36382, 36430, 36471, 36494, 36621, 36635, 36645, 36871, 36909, 36930, 37069, 37141, 37171, 37283, 37315, 37446, 37462, 37596, 37670, 37726, 37749, 37877, 37895, 37952, 37972, 38139, 38152, 38194, 38264, 38330, 38370, 38380, 38410, 38454, 38554, 38567, 38616, 38683, 38862, 38930, 38967, 38977, 38980, 38987, 38999, 39008, 39068, 39069, 39085, 39097, 39231, 39308, 39313, 39360, 39608, 39615, 39682, 39822, 39918, 40014, 40028, 40038, 40204, 40283, 40558, 40616, 40626, 40645, 40859, 40881, 40993, 41028, 41278, 41297, 41410, 41428, 41512, 41614, 41665, 41712, 41800, 41823, 41833, 41840, 41863, 42284, 42329, 42361, 42365, 42368, 42391, 42439, 42563, 42586, 42618, 42727, 42763, 42855, 42865, 42891, 42925, 42985, 43025, 43026, 43161, 43162, 43199, 43320, 43370, 43399, 43488, 43551, 43744, 43832, 43849, 44020, 44070, 44163, 44189, 44413, 44603, 44614, 44620, 44725, 44812, 44864, 44914, 44951, 45001, 45015, 45111, 45299, 45328, 45367, 45490, 45569, 45664, 45725, 45768, 45856, 45886, 45942, 45979, 46007, 46013, 46057, 46147, 46410, 46430, 46491, 46738, 46743, 46765, 46817, 46824, 46896, 47010, 47241, 47284, 47301, 47334, 47376, 47491, 47544, 47674, 47725, 47740, 47743, 47744, 47958, 47959, 48279, 48355, 48379, 48397, 48480, 48499, 48526, 48668, 48773, 48779, 48809, 49161, 49181, 49262, 49410, 49635, 49704, 49745, 49816, 49873, 49938, 50037, 50048, 50273, 50358, 50430, 50438, 50443, 50538, 50598, 50678, 50771, 50846, 50903, 50929, 50971, 50980, 51100, 51241, 51288, 51362, 51437, 51491, 51503, 51648, 51680, 51687, 51788, 51856, 51909, 51968, 52104, 52153, 52178, 52195, 52319, 52387, 52661, 52754, 52816, 52991, 53078, 53090, 53173, 53340, 53452, 53460, 53633, 53645, 53846, 53940, 54034, 54049, 54169, 54307, 54320, 54336, 54446, 54484, 54574, 54722, 54856, 54994, 55165, 55172, 55226, 55351, 55369, 55511, 55530, 55630, 55633, 55706, 55760, 55815, 55840, 55849, 55917, 55968, 56069, 56110, 56111, 56152, 56237, 56254, 56296, 56427, 56460, 56470, 56502, 56514, 56543, 56630, 56754, 56769, 57100, 57114, 57125, 57128, 57156, 57167, 57176, 57236, 57275, 57322, 57345, 57425, 57642, 57712, 57754, 57898, 57921, 57938, 58012, 58030, 58049, 58250, 58392, 58668, 58698, 58714, 58943, 58954, 58980, 59121, 59247, 59310, 59363, 59393, 59432, 59703, 60175, 60421, 60511, 60512, 60544, 60546, 60573, 60671, 60971, 61060, 61063, 61076, 61215, 61267, 61282, 61417, 61425, 61552, 61634, 61736, 61850, 62027, 62083, 62134, 62135, 62279, 62322, 62330, 62332, 62343, 62357, 62366, 62395, 62443, 62493, 62729, 62758, 62939, 62976, 63004, 63053, 63181, 63235, 63276, 63285, 63386, 63462, 63499, 63503, 63508, 63527, 63540, 63598, 63671, 63694, 63718, 63720, 63798, 63864, 64011, 64195, 64199, 64278, 64345, 64385, 64433, 64439, 64486, 64526, 64593, 64658, 64703, 64712, 64853, 64904, 64908, 65080, 65103, 65115, 65161, 65164, 65260, 65273, 65300, 65435, 65449, 65534, 65556, 65672, 65700, 65701, 65779, 66114, 66270, 66350, 66373, 66401, 66466, 66651, 66724, 66848, 66906, 67051, 67079, 67221, 67279, 67377, 67513, 67535, 67546, 67699, 67786, 67930, 68006, 68023, 68147, 68151, 68192, 68201, 68213, 68335, 68351, 68373, 68410, 68462, 68618, 68619, 68627, 68639, 68935, 69030, 69043, 69097, 69099, 69180, 69242, 69318, 69356, 69427, 69544, 69839, 69861, 69916, 69953, 69992, 70309, 70518, 70602, 70671, 70687, 70706, 71330, 71352, 71480, 71491, 71552, 71707, 71741, 71765, 71906, 71910, 72249, 72342, 72387, 72476, 72557, 72568, 72578, 72626, 72636, 72703, 72757, 72898, 72918, 72939, 72953, 72981, 73112, 73188, 73429, 73449, 73498, 73562, 73678, 73749, 73751, 73796, 73886, 73964, 74009, 74062, 74068, 74086, 74091, 74129, 74137, 74241, 74368, 74509, 74697, 74736, 74875, 74903, 74934, 74961, 74991, 75087, 75157, 75158, 75292, 75380, 75444, 75589, 75658, 75747, 75925, 76012, 76027, 76028, 76087, 76247, 76331, 76347, 76389, 76463, 76561, 76577, 76689, 76792, 76805, 76940, 76993, 77150, 77151, 77176, 77228, 77443, 77545, 77643, 78040, 78072, 78130, 78142, 78175, 78193, 78260, 78480, 78531, 78559, 78572, 78679, 78701, 78759, 78862, 78923, 78940, 78989, 79042, 79101, 79147, 79177, 79189, 79205, 79210, 79530, 79595, 79630, 79668, 79751, 79833, 79891, 79901, 80046, 80134, 80186, 80202, 80234, 80394, 80471, 80543, 80644, 80680, 80810, 80903, 80984, 81085, 81086, 81152, 81271, 81272, 81305, 81334, 81382, 81550, 81724, 81814, 81815, 81894, 81947, 82105, 82167, 82201, 82317, 82447, 82522, 82535, 82602, 82669, 82746, 82818, 82860, 82943, 82977, 82991, 83101, 83106, 83161, 83175, 83287, 83314, 83537, 83635, 83665, 83703, 83735, 83762, 83853, 83877, 83902, 83969, 83970, 83986, 84003, 84151, 84336, 84476, 84538, 84642, 84731, 84770, 84934, 84964, 85122, 85126, 85211, 85221, 85241, 85303, 85436, 85438, 85497, 85547, 85551, 85641, 85764, 85905, 85920, 86150, 86191, 86227, 86251, 86286, 86455, 86576, 86614, 86712, 86838, 86891, 86903, 86922, 87064, 87073, 87086, 87371, 87383, 87484, 87504, 87562, 87586, 87677, 87915, 88259, 88308, 88326, 88350, 88508, 88509, 88624, 88658, 88660, 88668, 88695, 88731, 88826, 88976, 88986, 89159, 89281, 89332, 89335, 89371, 89572, 89850, 89931, 89983, 89997, 90150, 90163, 90230, 90286, 90342, 90411, 90450, 90502, 90543, 90549, 90567, 90571, 90614, 90679, 90685, 90766, 90962, 91043, 91155, 91222, 91267, 91494, 91523, 91745, 91882, 91883, 91900, 91949, 92000, 92218, 92334, 92354, 92356, 92757, 92799, 92806, 92940, 92993, 93000, 93034, 93088, 93097, 93224, 93247, 93333, 93443, 93477, 93571, 93764, 93794, 93819, 93823, 93848, 93859, 93906, 93931, 93936, 94031, 94061, 94226, 94235, 94327, 94448, 94472, 94520, 94609, 94668, 94719, 94902, 95434, 95437, 95484, 95560, 95599, 95607, 95702, 95738, 95756, 95760, 95885, 95927, 95958, 95975, 95979, 95981, 96002, 96194, 96226, 96261, 96386, 96538, 96567, 96611, 96641, 96655, 96709, 96967, 97000, 97137, 97232, 97271, 97386, 97470, 97514, 97545, 97584, 97711, 98090, 98185, 98254, 98342, 98448, 98571, 98572, 98637, 98655, 98656, 98737, 98784, 98879, 98905, 98942, 99141, 99147, 99175, 99427, 99606, 99608, 99619, 99736, 99790, 99856, 99858, 99885, 99932, 100052, 100103, 100104, 100132, 100248, 100360, 100554, 100592, 100675, 100742, 100770, 100879, 100882, 100902, 101105, 101244, 101380, 101468, 101483, 101641, 101815, 101885, 101921, 101924, 101935, 102008, 102009, 102063, 102102, 102103, 102137, 102181, 102184, 102258, 102262, 102278, 102293, 102296, 102315, 102349, 102501, 102556, 102670, 102838, 102975, 102980, 103077, 103100, 103102, 103181, 103234, 103268, 103298, 103307, 103308, 103860, 103951, 103952, 103995, 104123, 104236, 104314, 104522, 104620, 104661, 104764, 104975, 105071, 105211, 105232, 105290, 105329, 105362, 105540, 105570, 105768, 105853, 105890, 106008, 106121, 106199, 106236, 106284, 106297, 106414, 106478, 106596, 106597, 106622, 106855, 107170, 107230, 107308, 107322, 107502, 107586, 107593, 107611, 107715, 107781, 107916, 108126, 108162, 108200, 108225, 108315, 108468, 108488, 108596, 108670, 108724, 108882, 108993, 109030, 109053, 109086, 109162, 109165, 109288, 109289, 109575, 109609, 109713, 109888, 109921, 110211, 110224, 110254, 110278, 110309, 110435, 110576, 110601, 110843, 110935, 110937, 110968, 111019, 111113, 111301, 111440, 111443, 111597, 111686, 111699, 111876, 112007, 112036, 112120, 112144, 112162, 112191, 112313, 112318, 112324, 112344, 112442, 112611, 112656, 112689, 112867, 112929, 113015, 113280, 113369, 113379, 113428, 113486, 113592, 113687, 113690, 113845, 113944, 113973, 114024, 114101, 114247, 114248, 114278, 114407, 114432, 114500, 114581, 114633, 114689, 114694, 114770, 114897, 114907, 115224, 115225, 115246, 115415, 115461, 115574, 115597, 115907, 115948, 116194, 116204, 116246, 116247, 116292, 116307, 116391, 116400, 116470, 116598, 116607, 116638, 116770, 116869, 117094, 117127, 117128, 117303, 117410, 117414, 117442, 117525, 117708, 117714, 117732, 117743, 117777, 118041, 118066, 118077, 118152, 118256, 118260, 118316, 118369, 118381, 118388, 118418, 118561, 118832, 119030, 119095, 119110, 119175, 119234, 119267, 119283, 119376, 119447, 119479, 119646, 119715, 119921, 120129, 120336, 120375, 120819, 120972, 121020, 121057, 121138, 121251, 121339, 121414, 121496, 121503, 121649, 121728, 121735, 121831, 121893, 121989, 122065, 122193, 122225, 122233, 122353, 122497, 122576, 122677, 122894, 122921, 122992, 123209, 123574, 123676, 123696, 123875, 124046, 124092, 124218, 124224, 124313, 124395, 124439, 124467, 124549, 124763, 124945, 125018, 125123, 125135, 125142, 125148, 125189, 125491, 125530, 125545, 125668, 125671, 125680, 125761, 125773, 125945, 125960, 126026, 126080, 126251, 126292, 126489, 126528, 126560, 126652, 126787, 126894, 127147, 127164, 127194, 127253, 127413, 127452, 127612, 127618, 127628, 127871, 127885, 127919, 127970, 128044, 128050, 128240, 128415, 128464, 128465, 128619, 128682, 128967, 128972, 129213, 129252, 129257, 129399, 129406, 129476, 129477, 129674, 129717, 129718, 129721, 129842, 129928, 130158, 130168, 130544, 130641, 130644, 130645, 130875, 130876, 130935, 131260, 131336, 131356, 131441, 131578, 131661, 131778, 131969, 131994, 132049, 132050, 132215, 132273, 132356, 132394, 132535, 132611, 132612, 132638, 132739, 132748, 132782, 132834, 132878, 132891, 132939, 132944, 133031, 133073, 133110, 133124, 133165, 133312, 133382, 133395, 133516, 133527, 133588, 133694, 133944, 133959, 133967, 134107, 134206, 134245, 134246, 134274, 134296, 134356, 134388, 134680, 134701, 135015, 135130, 135331, 135340, 135378, 135523, 135776, 135924, 136097, 136137, 136199, 136354, 136417, 136423, 136469, 136683, 136876, 136886, 137015, 137154, 137424, 137602, 137668, 137672, 137795, 137957, 137991, 138053, 138054, 138100, 138166, 138218, 138283, 138390, 138397, 138453, 138481, 138488, 138605, 138607, 138660, 138663, 138680, 138756, 138933, 138941, 139253, 139428, 139594, 139685, 139723, 140017, 140027, 140154, 140292, 140293, 140467, 140527, 140529, 140570, 140575, 140651, 140695, 140731, 140828, 140922, 141236, 141298, 141308, 141424, 141540, 141652, 141658, 141672, 141724, 141725, 141797, 142076, 142172, 142317, 142437, 142607, 142828, 142938, 143061, 143125, 143170, 143345, 143421, 143450, 143512, 143870, 143926, 143971, 144291, 144308, 144362, 144415, 144478, 144654, 144714, 145146, 145172, 145237, 145346, 145493, 145563, 145567, 145613, 145623, 145910, 145917, 145924, 145991, 146053, 146166, 146174, 146184, 146286, 146300, 146568, 146687, 147079, 147203, 147376, 147439, 147475, 147517, 147542, 147568, 147736, 147748, 147772, 147794, 147806, 147810, 147842, 147874, 148044, 148050, 148109, 148157, 148302, 148394, 148402, 148470, 148590, 148917, 148968, 148984, 149223, 149295, 149298, 149301, 149642, 149647, 149702, 149756, 149796, 149915, 149983, 149987, 149994, 149995, 150054, 150056, 150131, 150172, 150402, 150409, 150459, 150607, 150741, 150759, 150812, 150879, 150945, 151002, 151119, 151208, 151345, 151346, 151347, 151437, 151501, 151502, 151632, 151642, 151698, 151923, 151932, 151984, 152190, 152270, 152342, 152373, 152376, 152510, 152511, 152576, 152640, 152787, 152837, 152965, 152997, 153098, 153301, 153306, 153343, 153398, 153739, 153791, 153980, 154133, 154134, 154194, 154207, 154346, 154403, 154640, 154644, 154645, 154778, 154885, 155099, 155124, 155152, 155153, 155207, 155375, 155452, 155548, 155669, 155805, 155874, 155888, 155941, 155952, 156012, 156021, 156153, 156230, 156239, 156247, 156296, 156376, 156452, 156554, 156593, 156626, 156646, 156691, 156703, 156764, 156786, 156873, 156874, 156909, 156920, 157180, 157283, 157299, 157350, 157405, 157448, 157499, 157517, 157650, 157761, 157777, 158020, 158208, 158220, 158265, 158314, 158441, 158479, 158493, 158605, 158621, 158776, 158785, 158847, 158896, 159074, 159206, 159283, 159406, 159531, 159636, 159687, 160137, 160215, 160216, 160267, 160343, 160501, 160589, 160624, 160664, 160733, 160852, 160953, 160961, 160992, 161311, 161357, 161365, 161512, 161651, 161696, 161775, 161803, 161817, 161834, 161867, 161869, 161879, 161973, 162112, 162117, 162163, 162179, 162180, 162237, 162385, 162445, 162500, 162574, 162678, 162723, 162918, 163012, 163085, 163331, 163355, 163410, 163438, 163500, 163577, 163581, 163631, 163773, 163902, 163956, 164028, 164035, 164036, 164207, 164335, 164336, 164493, 164520, 164535, 164617, 164618, 164665, 164676, 164772, 164968, 165039, 165121, 165126, 165131, 165226, 165375, 165402, 165549, 165566, 165653, 165681, 165702, 165730, 165823, 165978, 165990, 166030, 166061, 166137, 166293, 166453, 166532, 166537, 166561, 166789, 167060, 167081, 167091, 167103, 167191, 167192, 167243, 167267, 167417, 167491, 167590, 167674, 167939, 167954, 168017, 168065, 168096, 168374, 168755, 168898, 168964, 168997, 169033, 169050, 169064, 169121, 169291, 169652, 169670, 169737, 169746, 169782, 169818, 169842, 170209, 170210, 170298, 170299, 170370, 170547, 170612, 170637, 170754, 170795, 170813, 170832, 170953, 170991, 171048, 171063, 171136, 171319, 171504, 171526, 171619, 171768, 171781, 171796, 171868, 171877, 171981, 172066, 172075, 172129, 172191, 172219, 172292, 172345, 172400, 172424, 172501, 172559, 172837, 172838, 172917, 172934, 172943, 172996, 173002, 173007, 173068, 173213, 173291, 173703, 173820, 173849, 173874, 173968, 173987, 174052, 174224, 174238, 174242, 174435, 174436, 174510, 174879, 174891, 174923, 175008, 175151, 175171, 175233, 175292, 175327, 175348, 175418, 175565, 175590, 175608, 175703, 175985, 176048, 176074, 176158, 176451, 176464, 176586, 176640, 176643, 176856, 177007, 177021, 177622, 177623, 177803, 177916, 177917, 177929, 178023, 178068, 178110, 178206, 178270, 178308, 178313, 178488, 178568, 178617, 178974, 179079, 179142, 179174, 179345, 179513, 179514, 179545, 179602, 179651, 179693, 179798, 179871, 179984, 180075, 180140, 180183, 180378, 180410, 180616, 180617, 180762, 180763, 180780, 181087, 181169, 181276, 181365, 181644, 181702, 181735, 181899, 181955, 182033, 182049, 182309, 182385, 182398, 182410, 182411, 182491, 182616, 182874, 182912, 183025, 183072, 183172, 183173, 183284, 183386, 183618, 184023, 184025, 184028, 184120, 184168, 184207, 184224, 184312, 184316, 184333, 184350, 184437, 184566, 184670, 184672, 184685, 184871, 184887, 184949, 184978, 185332, 185340, 185341, 185420, 185421, 185502, 185527, 185571, 185659, 185819, 185917, 186131, 186240, 186250, 186268, 186377, 186447, 186585, 186858, 186882, 186998, 187085, 187312, 187321, 187392, 187542, 187593, 187853, 187977, 187996, 188120, 188322, 188405, 188516, 188532, 188600, 188691, 188700, 188720, 188793, 188827, 188849, 188939, 189088, 189224, 189340, 189341, 189342, 189497, 189539, 189688, 189699, 189722, 189792, 189850, 190024, 190044, 190059, 190149, 190257, 190344, 190363, 190427, 190453, 190470, 190501, 190544, 190679, 190770, 190771, 190785, 190824, 190924, 191010, 191129, 191147, 191190, 191222, 191236, 191462, 191484, 191561, 191595, 191688, 191838, 191927, 192135, 192211, 192226, 192321, 192341, 192378, 192685, 192686, 192803, 192854, 192894, 192912, 192971, 193223, 193251, 193456, 193636, 193782, 193855, 193901, 194022, 194103, 194117, 194322, 194382, 194406, 194411, 194636, 194713, 194819, 194834, 194908, 194960, 194979, 195042, 195126, 195194, 195246, 195361, 195439, 195485, 195503, 195682, 195809, 196042, 196071, 196187, 196207, 196284, 196287, 196384, 196421, 196422, 196441, 196497, 196570, 196621, 196688, 196725, 196755, 196831, 196844, 196860, 196869, 196947, 196973, 197009, 197321, 197393, 197408, 197432, 197511, 197691, 197739, 197763, 197868, 197877, 197893, 198014, 198097, 198197, 198198, 198295, 198310, 198542, 198629, 198670, 198748, 199022, 199085, 199095, 199126, 199209, 199226, 199285, 199441, 199467, 199574, 199575, 199583, 199609, 199686, 199687, 199743, 199772, 199783, 199803, 199879, 199918, 200010, 200061, 200233, 200269, 200288, 200417, 200511, 200609, 200623, 200639, 200756, 200808, 200835, 200920, 200999, 201088, 201101, 201115, 201452, 201472, 201491, 201575, 201580, 201611, 201679, 201728, 201832, 201995, 202111, 202185, 202345, 202448, 202700, 202739, 202832, 202866, 202895, 202972, 202973, 203015, 203114, 203126, 203217, 203248, 203249, 203297, 203322, 203548, 203681, 203702, 203708, 204043, 204098, 204099, 204348, 204424, 204449, 204456, 204480, 204584, 204611, 204612, 204613, 204635, 204700, 204844, 204967, 205051, 205085, 205321, 205322, 205638, 205704, 205705, 205858, 205899, 205978, 205996, 206024, 206245, 206258, 206325, 206438, 206500, 206501, 206561, 206633, 206778, 206879, 206900, 206901, 207059, 207117, 207399, 207400, 207423, 207494, 207631, 207757, 207892, 207916, 208028, 208120, 208165, 208206, 208300, 208412, 208533, 208540, 208541, 208559, 208560, 208660, 208754, 208788, 208839, 208949, 209032, 209040, 209064, 209074, 209075, 209116, 209154, 209194, 209429, 209705, 209973, 210206, 210231, 210395, 210506, 210691, 210743, 210805, 210806, 210836, 211041, 211066, 211067, 211153, 211166, 211181, 211350, 211488, 211489, 211582, 211695, 211701, 211727, 211741, 211855, 211856, 211886, 211965, 212119, 212238, 212239, 212412, 212654, 212697, 212807, 212853, 212854, 213059, 213212, 213378, 213379, 213380, 213413, 213556, 213633, 213786, 213787, 213788, 213831, 213906, 213944, 213984, 214074, 214081, 214091, 214197, 214205, 214250, 214355, 214663, 214677, 214678, 214778, 214806, 214817, 214939, 214976, 215085, 215200, 215261, 215405, 215468, 215618, 215644, 215648, 215669, 215770, 215897, 215930, 215954, 216029, 216036, 216067, 216167, 216336, 216724, 216748, 216972, 216990, 217033, 217034, 217266, 217284, 217304, 217322, 217595, 217617, 217618, 217649, 217762, 217763, 217883, 218004, 218024, 218045, 218088, 218132, 218210, 218314, 218484, 218631, 218762, 218763, 218764, 218781, 219150, 219151, 219223, 219299, 219429, 219736, 219744, 219877, 219879, 219976, 220041, 220146, 220218, 220934, 220949, 221066, 221265, 221577, 221643, 221651, 221922, 221954, 222070, 222095, 222096, 222140, 222697, 222698, 222736, 222737, 222824, 222849, 223118, 223160, 223181, 223311, 223428, 223429, 223480, 223503, 223585, 223615, 223616, 223755, 223881, 223892, 223898, 223899, 224069, 224129, 224220, 224239, 224300, 224301, 224302, 224448, 224703, 224735, 224837, 224874, 224896, 224999, 225000, 225008, 225066, 225205, 225228, 225348, 225349, 225350, 225369, 225391, 225392, 225498, 225570, 225686, 225868, 226028, 226126, 226294, 226295, 226354, 226428, 226458, 226554, 226624, 226952, 227072, 227083, 227118, 227209, 227341, 227369, 227408, 227497, 227498, 227849, 227995, 228032, 228118, 228144, 228188, 228448, 228479, 228480, 228725, 228744, 228774, 228913, 228933, 228994, 229107, 229125, 229255, 229263, 229264, 229332, 229333, 229334, 229423, 229446, 229463, 229568, 229575, 229590, 229635, 229835, 229935, 230054, 230074, 230086, 230207, 230256, 230285, 230397, 230404, 230467, 230594, 230618, 230619, 230636, 230638, 230639, 230933, 231143, 231200, 231230, 231360, 231381, 231382, 231439, 231457, 231553, 231616, 231638, 231729, 231755, 231782, 231925, 232038, 232068, 232069, 232080, 232086, 232087, 232389, 232390, 232415, 232759, 232903, 232939, 232971, 232999, 233102, 233182, 233319, 233348, 233373, 233374, 233491, 233627, 233796, 233825, 233860, 233975, 234012, 234110, 234144, 234325, 234372, 234373, 234472, 234473, 234494, 234615, 234663, 234683, 234809, 235004, 235133, 235162, 235163, 235186, 235301, 235329, 235341, 235363, 235473, 235495, 235665, 235799, 236096, 236355, 236366, 236403, 236541, 236617, 236712, 236738, 236739, 236740, 236854, 236871, 236882, 237068, 237250, 237267, 237291, 237292, 237355, 237398, 237416, 237506, 237706, 237730, 237846, 237847, 237891, 237919, 238062, 238071, 238147, 238232, 238261, 238262, 238263, 238362, 238389, 238521, 238551, 238714, 238894, 238899, 239073, 239122, 239219, 239246, 239247, 239582, 239615, 239616, 239758, 239772, 239951, 240108, 240126, 240303, 240304, 240406, 240600, 240613, 240749, 240765, 240772, 240918, 241101, 241129, 241130, 241150, 241312, 241334, 241371, 241372, 241486, 241495, 241687, 241706, 241707, 241856, 241998, 242027, 242042, 242178, 242198, 242221, 242247, 242248, 242384, 242409, 242541, 242586, 242615, 242624, 242712, 242736, 242737, 242758, 242907, 242929, 242972, 242999, 243103, 243140, 243321, 243322, 243477, 243512, 243736, 243749, 243780, 243875, 243886, 243887, 244073, 244123, 244146, 244247, 244444, 244512, 244645, 244661, 244672, 244673, 244810, 244811, 244816, 244856, 244882, 244991, 245006, 245007, 245008, 245022, 245178, 245189, 245351, 245352, 245374, 245427, 245535, 245545, 245564, 245590, 245591, 245648, 245749, 245750, 245801, 245930, 246147, 246164, 246264, 246275, 246366, 246516, 246517, 246518, 246665, 246731, 246757, 246891, 246911, 246943, 246944, 247128, 247129, 247260, 247314, 247315, 247347, 247409, 247506, 247608, 247621, 247637, 247655, 247691, 247699, 247802, 247855, 247865, 247893, 248012, 248075, 248079, 248105, 248108, 248116, 248120, 248123, 248124, 248126, 248130, 248141, 248144, 248147, 248160, 248161, 248168, 248193, 248203, 248210, 248212, 248215, 248262, 248268, 248280, 248283, 248414, 248415, 248504, 248515, 248759, 248950, 249179, 249187, 249335, 249449, 249467, 249469, 249489, 249519, 249641, 249871, 249908, 249987, 250023, 250082, 250117, 250190, 250220, 250259, 250390, 250428, 250470, 250479, 250533, 250555, 250582, 250603, 250635, 250655, 250694, 250754, 250764, 250816, 250840, 250843, 250872, 250897, 250909, 250970, 250989, 251014, 251041, 251059, 251072, 251098, 251112, 251129, 251131, 251146, 251154, 251173, 251196, 251205, 251216, 251275, 251369, 251413, 251456, 251460, 251487, 251503, 251505, 251590, 251647, 251659, 251666, 251743, 251747, 251756, 251787, 251804, 251873, 251908, 251912, 251934, 251941, 251960, 251987, 252013, 252019, 252048, 252073, 252084, 252160, 252180, 252202, 252218, 252257, 252263, 252273, 252323, 252340, 252482, 252496, 252655, 252661, 252853, 252920, 252991, 252995, 253037, 253077, 253096, 253108, 253321, 253403, 253406, 253459, 253685, 253756, 253865, 253990, 254377, 254500, 254539, 254570, 254742, 254812, 254845, 254877, 254949, 254964, 255023, 255102, 255155, 255202, 255271, 255466, 255482, 255553, 255557, 255767, 255876, 255886, 255891, 255892, 255893, 255976, 255977 
                ]
            for i in range(len(line_list1)):
                tokenized1 = tokenizer(line_list1[i])
                tokenized2 = tokenizer(line_list2[i])
                for token_id in tokenized1['input_ids']:
                    if token_id in tokenized2['input_ids'] and token_id not in special_tokens:
                        if token_id in mutual_token_count.keys():
                            mutual_token_count[token_id] += 1
                        else:
                            mutual_token_count[token_id] = 1
            mutual_token_count = {k: v for k, v in mutual_token_count.items() if v > filter_num}
            print(f"Mutual token dictionary created")
            #pmi_count_dictionary = {} # Key: token_pmi Value: token_count
            token_counter = {} #Key: token_id Value: [in_first, in_second]
            token_pmi_dict = {}
            for i in range(len(line_list1)):
                tokenized1 = tokenizer(line_list1[i])
                tokenized2 = tokenizer(line_list2[i])
                for token_num, count in mutual_token_count.items():
                    if token_num not in token_counter.keys():
                        token_counter[token_num] = [0,0]
                    if token_num in tokenized1['input_ids']:
                        token_counter[token_num][0] += 1
                        if token_num in tokenized2['input_ids']:
                            token_counter[token_num][1] += 1
                    elif token_num in tokenized2['input_ids']:
                        token_counter[token_num][1] += 1
                    if i == len(line_list1) - 1:
                        r = (count*len(line_list1))/(token_counter[token_num][1]*token_counter[token_num][0])
                        token_pmi = math.log2(r)
                        token_pmi_dict[tokenizer.convert_ids_to_tokens(token_num)] = token_pmi
                        #if token_pmi in pmi_count_dictionary.keys():
                            #pmi_count_dictionary[token_pmi] += count
                        #else:
                            #pmi_count_dictionary[token_pmi] = count
            #sum_count = 0
            #pmi_weighted_sum = 0
            #for pmi_value, count in pmi_count_dictionary.items():
                #sum_count += count
                #pmi_weighted_sum += count*pmi_value
            #pmi_weighted_mean = (pmi_weighted_sum/sum_count)*(len(mutual_token_count.keys()))
            #return pmi_weighted_mean
            with open (OUT_DIR / f"{lang_code1}_{lang_code2}_pmi_ranking.txt", "w") as f:
                print("Starting writing process")
                sorted_pmi = sorted(token_pmi_dict.items(), key=lambda kv: kv[1], reverse=True)
                for token, pmi in sorted_pmi:
                    f.write(f"{token} PMI: {pmi}\n")
            print(f"Success: the pmi info for{lang_code1} and {lang_code2} is stored in {OUT_DIR}/{lang_code1}_{lang_code2}_pmi_ranking.")
            k+=1
            print(f"{k}/190 language pairs done!")
                


LANGS = [
    "bg", "cs", "da", "de", "el",
    "es", "et", "fi", "fr", "hu",
    "it", "lt", "lv", "nl", "pl",
    "pt", "ro", "sk", "sl", "sv", "en"
    ]

result = similarity_index(LANGS, tokenizer, 0)